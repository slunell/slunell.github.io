<!DOCTYPE html>
<html>

<head>
    <meta charset=utf-8>
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <title>Polygons</title>

    <script src="js/three.js"></script>
    <script src="js/OrbitControls.js"></script>

    <style>
        #main {
            overflow: hidden;
        }

        body {
            margin: 0;
        }

    </style>
</head>

<body>
    <div id="main"></div>

    <script>
        var WIDTH = window.innerWidth;
        var HEIGHT = window.innerHeight * .99;
        var ASPECT = WIDTH / HEIGHT;

        var scene, camera, renderer, controls;
        var polygons = [];
        var palette1 = ['#E3DFFF', '#D3C0CD', '#B19994', '#937666', '#3D3A4B'];
        var palette2 = ['#393D3F', '#f2f2f2', '#C6C5B9', '#62929E', '#546A7B'];
        var palette3 = ['#BFB5AF', '#ECE2D0', '#D5B9B2', '#A26769', '#582C4D'];

        function init() {
            // create a WebGL renderer inside an existing dom element (id=main)
            renderer = new THREE.WebGLRenderer();
            renderer.setClearColor(new THREE.Color('white'));
            renderer.setSize(WIDTH, HEIGHT);

            document.getElementById("main").appendChild(renderer.domElement);

            scene = new THREE.Scene();

            // Add camera
            camera = new THREE.PerspectiveCamera(45, ASPECT, 1, 10000);
            scene.add(camera);
            // the camera starts at 0,0,0, so pull it back
            camera.position.set(100, 30, 50);


            // Move camera around
            controls = new THREE.OrbitControls(camera, renderer.domElement);




            // Main part of the code
            var num_shapes = 125;
            for (var i = 0; i < num_shapes; i++) {
                var polygon = createShape(1);
                polygon.position.x = randX();
                polygon.position.y = -10;
                polygon.position.z = randZ();
                polygon.rotation.y = randRotation();
                polygon.scale.set(1.5, 1.5, 1.5);
                polygons.push(polygon);
            }
            for (var i = 0; i < num_shapes; i++) {
                var polygon = createShape(2);
                polygon.position.x = randX();
                polygon.position.y = 10;
                polygon.position.z = randZ();
                polygon.rotation.y = randRotation();
                polygon.scale.set(1.5, 1.5, 1.5);
                polygons.push(polygon);
            }
            for (var i = 0; i < num_shapes; i++) {
                var polygon = createShape(3);
                polygon.position.x = randX();
                polygon.position.y = 30;
                polygon.position.z = randZ();
                polygon.rotation.y = randRotation();
                polygon.scale.set(1.5, 1.5, 1.5);
                polygons.push(polygon);
            }


            renderer.render(scene, camera);
            animate();
        }

        // Random radian value
        function randRotation() {
            return Math.random() * (2 * Math.PI);
        }

        function randX() {
            return Math.random() * (10 - (1)) + (1);
        }

        function randZ() {
            return Math.random() * (50 - (-50)) + (-50);
        }

        function createShape(pal) {
            var pts = [];

            var pt1x = Math.random() * (0 - (-5)) + (-5);
            var pt1y = Math.random() * (5 - (0)) + (0);

            var pt2x = Math.random() * (5 - (0)) + (0);
            var pt2y = Math.random() * (5 - (0)) + (0);

            var pt3x = Math.random() * (0 - (-5)) + (-5);
            var pt3y = Math.random() * (0 - (-5)) + (-5);

            var pt4x = Math.random() * (5 - (0)) + (0);
            var pt4y = Math.random() * (0 - (-5)) + (-5);

            // Create shape
            pts = [];
            pts.push(new THREE.Vector2(pt1x, pt1y));
            pts.push(new THREE.Vector2(pt2x, pt2y));
            pts.push(new THREE.Vector2(pt3x, pt3y));
            pts.push(new THREE.Vector2(pt4y, pt4y));

            var shape = new THREE.Shape(pts);

            // Amount parameter is the thickness
            var geom = new THREE.ExtrudeGeometry(shape, {
                amount: 0.05,
                bevelEnabled: false
            });

            // Chooses random color from palette
            var col_idx = Math.floor(Math.random() * (4));
            var color = (pal == 1) ? palette1[col_idx] :
                (pal == 2) ? palette2[col_idx] :
                palette3[col_idx];

            var material = new THREE.MeshBasicMaterial({
                color: color,
                opacity: 0.80,
                transparent: true
            });

            var polygon = new THREE.Mesh(geom, material);

            scene.add(polygon);
            return polygon;
        }




        function animate() {
            requestAnimationFrame(animate);

            renderer.render(scene, camera);
        }

        init();

    </script>
</body>

</html>
